import"./modulepreload-polyfill.js";import{r as c,J as p,K as C,L as t,a as e,N as W,F as J,O as Q,P as ge,M as v,Q as M,c as he,o as we,R as be,S as Se,s as ke,e as Ce}from"./@vue.js";import{M as V,I as j,P as G,a as $e,b as X,B as Y,S as Z,F as ee,c as te,d as Ve,e as ae,R as le,T as Le,C as ne,O as Re,f as Ie,D as xe,L as se,H as qe,A as Te}from"./tdesign-vue-next.js";import{a as De}from"./axios.js";import{c as Oe}from"./cheerio.js";import"./tdesign-icons-vue-next.js";import"./sortablejs.js";import"./@popperjs.js";import"./domutils.js";import"./dom-serializer.js";import"./domelementtype.js";import"./entities.js";import"./domhandler.js";import"./cheerio-select.js";import"./css-select.js";import"./boolbase.js";import"./css-what.js";import"./nth-check.js";import"./parse5.js";import"./parse5-htmlparser2-tree-adapter.js";import"./htmlparser2.js";const oe=(m,_)=>{const i=m.__vccOpts||m;for(const[r,d]of _)i[r]=d;return i},Ee={__name:"Aside",props:{classList:Object},emits:["class-click"],setup(m,{emit:_}){const i=window.electron.ipcRenderer,r=_,d=(u,h)=>{o.value=h,r("class-click",u)},o=c(0),y=c(null),f=c({class_name:""}),L={class_name:[{required:!0,message:"标题必填"}]},R=({validateResult:u,firstError:h})=>{u===!0?i.sendSync("runSql",`INSERT INTO fav_class (class_name) VALUES('${f._value.class_name}')`):V.warning(h)},g=u=>{i.sendSync("runSql",`delete from fav_class where class_id = ${u}`)};return(u,h)=>{const q=j,$=G,E=$e,z=X,w=Y,N=Z,T=ee,U=te,n=Ve;return p(),C(n,{split:!0},{footer:t(()=>[e(U,{ref_key:"form",ref:y,rules:L,data:f.value,onSubmit:R,style:{height:"120px"}},{default:t(()=>[e(T,{label:"分类名称",name:"class_name","label-align":"top",layout:"inline"},{default:t(()=>[e(N,null,{default:t(()=>[e(z,{style:{width:"120px"},modelValue:f.value.class_name,"onUpdate:modelValue":h[0]||(h[0]=b=>f.value.class_name=b),placeholder:"请输入分类名称"},null,8,["modelValue"]),e(w,{ghost:"",theme:"primary",type:"submit",variant:"dashed"},{default:t(()=>[e(q,{name:"add"})]),_:1})]),_:1})]),_:1})]),_:1},8,["data"])]),default:t(()=>[(p(!0),W(J,null,Q(m.classList,(b,I)=>(p(),C(E,{key:I,onClick:A=>d(b.class_id,I),class:ge({actived:I==o.value})},{action:t(()=>[e($,{theme:"default",content:"是否删除",onConfirm:A=>g(b.class_id)},{default:t(()=>[e(q,{name:"delete"})]),_:2},1032,["onConfirm"])]),default:t(()=>[v(M(b.class_name)+" ",1)]),_:2},1032,["onClick","class"]))),128))]),_:1})}}},ze=oe(Ee,[["__scopeId","data-v-76fd92cd"]]),Ne={class:"mytable"},Ue={__name:"Content",props:["selectedId","classList"],setup(m){const _=window.electron.ipcRenderer,i=m,r=c(),d=c(0),o=c(!1),y=async a=>{await _.sendSync("runSql",`INSERT INTO fav_list (fav_url, fav_title, class_id) VALUES('${a.fav_url}', '${a.fav_title}', '${a.class_id}')`),g()},f=async a=>{let l="update favroite set fav_type = "+a.fav_type+" where fav_id = "+a.fav_id;await _.sendSync("runSql",l),g()},L=async a=>{await _.send("runSql",`delete from fav_list where fav_id = ${a.fav_id}`),g()},R=async a=>{if($.value.join(",").length===0)return V.warning("未选择任何数据!");await _.send("runSql",`delete from fav_list where fav_id in ( ${$.value.join(",")} )`),g()},g=async()=>{o.value=!0;const a=await _.sendSync("runSql",`select * from fav_list where class_id = ${i.selectedId}`).data;d.value=a.length,r.value=a;const l=setTimeout(()=>{o.value=!1,clearTimeout(l)},1e3)},u=he(async()=>{o.value=!0;const a=await _.sendSync("runSql",`select * from fav_list where class_id = ${i.selectedId}`).data;d.value=a.length,r.value=a;const l=setTimeout(()=>{o.value=!1,clearTimeout(l)},1e3)}),h=c({defaultCurrent:1,defaultPageSize:10,pageSizeOptions:[],total:d}),q=[{colKey:"any",type:"multiple"},{colKey:"fav_title",title:"标题",width:"800",ellipsis:!0},{colKey:"tools",title:"操作"}],$=c([]),E=(a,l)=>{$.value=a},z=a=>{window.electron.shell.openExternal(a)},w=c(!1),N=()=>{B.value=!1,w.value=!0,n.value=c([]),F.value="新增收藏"},T=()=>{w.value=!1},U=c(null),n=c({fav_title:"",fav_url:"",class_id:""}),b={fav_title:[{required:!0,message:"标题必填"}],fav_url:[{required:!0,message:"网址必填"}],class_id:[{required:!0,message:"类型必选"}]},I=()=>{V.success("重置成功")},A=async()=>{let a=n._value.fav_url;o.value=!0,await De.get(a).then(l=>{let S=Oe.load(l.data);n._value.fav_title=S("title").text(),o.value=!1}).catch(l=>{V.warning("获取标题失败，请检查网址是否正确"),o.value=!1})},ce=({validateResult:a,firstError:l})=>{a===!0?(B.value?f({fav_title:n._value.fav_title,fav_url:n._value.fav_url,fav_type:n._value.fav_type,fav_id:n._value.fav_id}):y({fav_title:n._value.fav_title,fav_url:n._value.fav_url,class_id:n._value.class_id}),V.success("提交成功"),w.value=!1):(console.log("Validate Errors: ",l,a),V.warning(l))},K=(a,{e:l})=>{l.preventDefault()},B=c(!1),_e=a=>{B.value=!0,n._value=a,w.value=!0,F.value="编辑收藏"},F=c("new");return we(()=>{}),(a,l)=>{const S=j,k=Y,x=Z,P=ae,ie=le,re=G,ue=Le,de=ne,H=X,D=ee,me=Re,fe=Ie,ve=te,pe=xe,ye=se;return p(),C(ye,{class:"custom"},{default:t(()=>[e(de,{style:{background:"#fff","-webkit-app-region":"no-drag",padding:"20px"}},{default:t(()=>[e(x,null,{default:t(()=>[e(k,{theme:"primary",onClick:N},{icon:t(()=>[e(S,{name:"bookmark-add"})]),default:t(()=>[v(" 新增收藏 ")]),_:1}),e(k,{theme:"danger",variant:"base",onClick:R},{icon:t(()=>[e(S,{name:"delete"})]),default:t(()=>[v(" 批量删除 ")]),_:1})]),_:1}),be("div",Ne,[u.value?(p(),C(ue,{key:0,data:r.value,columns:q,"row-key":"fav_id",size:"small",hover:!0,bordered:!1,pagination:h.value,onSelectChange:E,loading:o.value,"selected-row-keys":$.value,"select-on-row-click":!0,resizable:!1,"lazy-load":""},{fav_title:t(({row:s})=>[e(ie,{justify:"space-between"},{default:t(()=>[e(P,null,{default:t(()=>[v(M(s.fav_title),1)]),_:2},1024),e(P,null,{default:t(()=>[e(x,null,{default:t(()=>[e(S,{class:"iconbox",name:"edit",onClick:O=>_e({fav_id:`${s.fav_id}`,fav_url:`${s.fav_url}`,fav_title:`${s.fav_title}`,fav_type:`${s.fav_type}`})},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),tools:t(({row:s})=>[e(x,null,{default:t(()=>[e(k,{theme:"success",onClick:O=>z(s.fav_url),variant:"text"},{default:t(()=>[e(S,{name:"link"})]),_:2},1032,["onClick"]),e(re,{theme:"danger",placement:"right-bottom",content:"是否删除",onConfirm:O=>L(s)},{default:t(()=>[e(k,{theme:"danger",variant:"text"},{default:t(()=>[e(S,{name:"delete"})]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:1},8,["data","pagination","loading","selected-row-keys"])):Se("",!0)])]),_:1}),e(pe,{visible:w.value,"onUpdate:visible":l[3]||(l[3]=s=>w.value=s),footer:!1,header:F.value,placement:"top","on-confirm":T,onClose:T},{default:t(()=>[e(x,{direction:"vertical",size:"large",style:{width:"100%"}},{default:t(()=>[e(ve,{ref_key:"form",ref:U,rules:b,data:n.value,colon:!0,onReset:I,onSubmit:ce},{default:t(()=>[e(D,{label:"标题",name:"fav_title"},{default:t(()=>[e(H,{modelValue:n.value.fav_title,"onUpdate:modelValue":l[0]||(l[0]=s=>n.value.fav_title=s),placeholder:"请输入内容",onEnter:K},null,8,["modelValue"])]),_:1}),e(D,{label:"网址",name:"fav_url"},{default:t(()=>[e(H,{modelValue:n.value.fav_url,"onUpdate:modelValue":l[1]||(l[1]=s=>n.value.fav_url=s),placeholder:"请输入内容",onEnter:K},null,8,["modelValue"])]),_:1}),e(D,{label:"类型",name:"fav_type"},{default:t(()=>[e(fe,{modelValue:n.value.class_id,"onUpdate:modelValue":l[2]||(l[2]=s=>n.value.class_id=s)},{default:t(()=>[(p(!0),W(J,null,Q(m.classList,(s,O)=>(p(),C(me,{key:O,value:s.class_id,label:s.class_name},{default:t(()=>[v(M(s.class_name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(D,null,{default:t(()=>[e(x,{size:"small"},{default:t(()=>[e(k,{theme:"primary",type:"submit",disabled:o.value},{default:t(()=>[v("提交")]),_:1},8,["disabled"]),e(k,{theme:"success",onClick:A,loading:o.value},{default:t(()=>[v("获取标题")]),_:1},8,["loading"]),e(k,{theme:"default",variant:"base",type:"reset"},{default:t(()=>[v("重置")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["visible","header"])]),_:1})}}},Ae=oe(Ue,[["__scopeId","data-v-6c05da55"]]),Be={__name:"Header",setup(m){const _=window.electron.ipcRenderer,i=()=>{_.send("closeOtherWindow")};return(r,d)=>{const o=ae,y=j,f=le;return p(),C(f,{justify:"space-between",align:"middle",style:{padding:"var(--td-size-3)",background:"var(--td-brand-color-7)",color:"var(--td-font-white-1)",cursor:"pointer"}},{default:t(()=>[e(o,null,{default:t(()=>[v("我的收藏")]),_:1}),e(o,{title:"关闭",onClick:i},{default:t(()=>[e(y,{name:"close"})]),_:1})]),_:1})}}},Fe={__name:"App",setup(m){const _=window.electron.ipcRenderer,i=c([]),r=c(1),d=y=>{r.value=y},o=async()=>{i.value=await _.sendSync("runSql","select * from fav_class").data};return ke(()=>{_.sendSync("createTable"),o()}),(y,f)=>{const L=qe,R=Te,g=ne,u=se;return p(),C(u,null,{default:t(()=>[e(L,null,{default:t(()=>[e(Be)]),_:1}),e(u,null,{default:t(()=>[e(R,null,{default:t(()=>[e(ze,{classList:i.value,defaultValue:r.value,onClassClick:d},null,8,["classList","defaultValue"])]),_:1}),e(g,null,{default:t(()=>[e(Ae,{selectedId:r.value,classList:i.value},null,8,["selectedId","classList"])]),_:1})]),_:1})]),_:1})}}},Me=Ce(Fe);Me.mount("#app");
